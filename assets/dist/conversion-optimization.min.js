!function(n){"use strict";class e{constructor(){this.urgencyTimers={},this.socialProofData={},this.dynamicPricingHints={},this.init()}init(){WCEFPData.conversion_optimization&&(this.initUrgencyIndicators(),this.initSocialProof(),this.initDynamicPricingHints(),this.initScarcityIndicators(),this.initTrustBadges(),this.initExitIntentPopup(),this.initPriceComparisonFeatures())}initUrgencyIndicators(){n(".wcefp-widget").each(function(){const e=n(this),t=(e.data("product"),n('<div class="wcefp-urgency-container"></div>'));e.prepend(t);const i=(new Date).getTime()+24*Math.random()*60*60*1e3,a=()=>{const n=(new Date).getTime(),e=i-n;if(e>0){const n=Math.floor(e%864e5/36e5),i=Math.floor(e%36e5/6e4);t.html(`\n                            <div class="wcefp-urgency-timer">\n                                <span class="wcefp-urgency-icon">‚è∞</span>\n                                <span class="wcefp-urgency-text">Offerta speciale scade in:</span>\n                                <span class="wcefp-countdown">${n}h ${i}m</span>\n                            </div>\n                        `)}else t.html('\n                            <div class="wcefp-urgency-expired">\n                                <span class="wcefp-urgency-icon">‚ö°</span>\n                                <span class="wcefp-urgency-text">Prenotazione a prezzo normale</span>\n                            </div>\n                        ')};a(),setInterval(a,6e4)})}initSocialProof(){n(".wcefp-card, .wcefp-widget").each(function(){const e=n(this),t=(e.data("product-id")||e.data("product"),Math.floor(15*Math.random())+1),i=["nelle ultime 24 ore","oggi","questa settimana"],a=i[Math.floor(Math.random()*i.length)],c=n(`\n                    <div class="wcefp-social-proof">\n                        <span class="wcefp-social-proof-icon">üë•</span>\n                        <span class="wcefp-social-proof-text">\n                            ${t} persone hanno prenotato ${a}\n                        </span>\n                    </div>\n                `);if(e.append(c),Math.random()>.7){const t=n('\n                        <div class="wcefp-popular-badge">\n                            <span class="wcefp-badge-icon">üî•</span>\n                            <span class="wcefp-badge-text">Molto Richiesto</span>\n                        </div>\n                    ');e.append(t)}const s=(1.5*Math.random()+3.5).toFixed(1),o=Math.floor(500*Math.random())+50,p=n(`\n                    <div class="wcefp-rating-display">\n                        <div class="wcefp-stars">\n                            ${"‚òÖ".repeat(Math.floor(parseFloat(s)))}${"‚òÜ".repeat(5-Math.floor(parseFloat(s)))}\n                        </div>\n                        <span class="wcefp-rating-value">${s}</span>\n                        <span class="wcefp-review-count">(${o} recensioni)</span>\n                    </div>\n                `);e.append(p)})}initDynamicPricingHints(){n(".wcefp-widget .wcefp-price, .wcefp-card .wcefp-price").each(function(){const e=n(this),t=parseFloat(e.text().replace(/[^\d.,]/g,"").replace(",","."));if(t>0){if(Math.random()>.6){const i=t*(1+.3*Math.random()+.1),a=i-t,c=Math.round((i-t)/i*100),s=n(`\n                            <div class="wcefp-price-comparison">\n                                <span class="wcefp-original-price">‚Ç¨${i.toFixed(2)}</span>\n                                <span class="wcefp-savings">Risparmi ‚Ç¨${a.toFixed(2)} (${c}%)</span>\n                            </div>\n                        `);e.after(s)}const i=n('\n                        <div class="wcefp-price-alert">\n                            <span class="wcefp-alert-icon">üí∞</span>\n                            <span class="wcefp-alert-text">Prezzo garantito pi√π basso online!</span>\n                        </div>\n                    ');e.after(i)}})}initScarcityIndicators(){n(".wcefp-widget, .wcefp-card").each(function(){const e=n(this),t=Math.floor(20*Math.random())+1;let i="high",a="#ff4757",c="üö®";t>10?(i="low",a="#2ed573",c="‚úÖ"):t>5&&(i="medium",a="#ffa502",c="‚ö†Ô∏è");const s=n(`\n                    <div class="wcefp-scarcity wcefp-scarcity-${i}" style="color: ${a}">\n                        <span class="wcefp-scarcity-icon">${c}</span>\n                        <span class="wcefp-scarcity-text">Solo ${t} posti disponibili</span>\n                    </div>\n                `);e.find(".wcefp-availability").after(s)})}initTrustBadges(){const e=[{icon:"üîí",text:"Pagamento Sicuro SSL"},{icon:"üí≥",text:"Tutti i metodi di pagamento"},{icon:"üìû",text:"Supporto 24/7"},{icon:"üé´",text:"Cancellazione Gratuita"},{icon:"‚ö°",text:"Conferma Istantanea"}];n(".wcefp-widget").each(function(){const t=n(this),i=e.slice(0,3),a=n('<div class="wcefp-trust-badges"></div>');i.forEach(n=>{a.append(`\n                        <div class="wcefp-trust-badge">\n                            <span class="wcefp-trust-icon">${n.icon}</span>\n                            <span class="wcefp-trust-text">${n.text}</span>\n                        </div>\n                    `)}),t.append(a)})}initExitIntentPopup(){let e=!1;n(document).on("mouseout",n=>{!e&&n.clientY<50&&(e=!0,this.showExitIntentPopup())})}showExitIntentPopup(){const e="SAVE10NOW",t=n(`\n                <div class="wcefp-exit-intent-overlay">\n                    <div class="wcefp-exit-intent-popup">\n                        <button class="wcefp-popup-close">&times;</button>\n                        <div class="wcefp-popup-content">\n                            <h3>Aspetta! Non perdere questa offerta</h3>\n                            <p>Ottieni uno sconto del 10% sulla tua prenotazione</p>\n                            <div class="wcefp-discount-code">\n                                <input type="text" value="${e}" readonly>\n                                <button class="wcefp-copy-code">Copia Codice</button>\n                            </div>\n                            <p class="wcefp-popup-urgency">Offerta valida solo per i prossimi 15 minuti!</p>\n                            <button class="wcefp-popup-cta">Applica Sconto e Prenota</button>\n                        </div>\n                    </div>\n                </div>\n            `);n("body").append(t),t.find(".wcefp-popup-close, .wcefp-exit-intent-overlay").on("click",n=>{n.target===n.currentTarget&&t.fadeOut(300,()=>t.remove())}),t.find(".wcefp-copy-code").on("click",function(){const i=t.find('input[type="text"]')[0];i.select(),i.setSelectionRange(0,99999),document.execCommand("copy"),n(this).text("Copiato!").addClass("copied"),"undefined"!=typeof WCEFPAnalytics&&window.wcefpAnalytics&&window.wcefpAnalytics.track("discount_code_copied",{code:e,trigger:"exit_intent"})}),t.find(".wcefp-popup-cta").on("click",function(){"undefined"!=typeof WCEFPAnalytics&&window.wcefpAnalytics&&window.wcefpAnalytics.track("exit_intent_conversion",{code:e,action:"apply_discount"}),t.fadeOut(300,()=>t.remove()),n(".wcefp-widget").first()[0]?.scrollIntoView({behavior:"smooth"})}),t.fadeIn(300)}initPriceComparisonFeatures(){n(".wcefp-price").each(function(){const e=n(this),t=parseFloat(e.text().replace(/[^\d.,]/g,"").replace(",","."));if(t>0){const i=[{name:"Competitor A",price:1.2*t},{name:"Competitor B",price:1.15*t}],a=n(`\n                        <div class="wcefp-price-comparison-table">\n                            <div class="wcefp-comparison-header">\n                                <span class="wcefp-comparison-title">Confronto prezzi:</span>\n                            </div>\n                            <div class="wcefp-comparison-row wcefp-our-price">\n                                <span class="wcefp-provider">Il nostro prezzo</span>\n                                <span class="wcefp-price-value">‚Ç¨${t.toFixed(2)}</span>\n                                <span class="wcefp-best-price">‚ú® Miglior Prezzo</span>\n                            </div>\n                            ${i.map(n=>`\n                                <div class="wcefp-comparison-row">\n                                    <span class="wcefp-provider">${n.name}</span>\n                                    <span class="wcefp-price-value">‚Ç¨${n.price.toFixed(2)}</span>\n                                </div>\n                            `).join("")}\n                        </div>\n                    `);e.after(a)}})}}class t{constructor(){this.init()}init(){this.createChatWidget(),this.bindEvents()}createChatWidget(){const e=n('\n                <div class="wcefp-chat-widget">\n                    <div class="wcefp-chat-bubble">\n                        <span class="wcefp-chat-icon">üí¨</span>\n                        <span class="wcefp-chat-text">Serve aiuto?</span>\n                        <span class="wcefp-chat-close">&times;</span>\n                    </div>\n                    <div class="wcefp-chat-window" style="display: none;">\n                        <div class="wcefp-chat-header">\n                            <span class="wcefp-chat-title">Assistenza Clienti</span>\n                            <button class="wcefp-chat-minimize">‚àí</button>\n                        </div>\n                        <div class="wcefp-chat-messages">\n                            <div class="wcefp-chat-message wcefp-bot-message">\n                                <p>Ciao! üëã Come posso aiutarti con la tua prenotazione?</p>\n                                <div class="wcefp-quick-replies">\n                                    <button class="wcefp-quick-reply">Info prezzi</button>\n                                    <button class="wcefp-quick-reply">Disponibilit√†</button>\n                                    <button class="wcefp-quick-reply">Cancellazioni</button>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="wcefp-chat-input">\n                            <input type="text" placeholder="Scrivi un messaggio...">\n                            <button class="wcefp-chat-send">üì§</button>\n                        </div>\n                    </div>\n                </div>\n            ');n("body").append(e)}bindEvents(){n(document).on("click",".wcefp-chat-bubble",function(){n(".wcefp-chat-window").fadeToggle(300),n(".wcefp-chat-bubble").fadeOut(300)}),n(document).on("click",".wcefp-chat-minimize",function(){n(".wcefp-chat-window").fadeOut(300),n(".wcefp-chat-bubble").fadeIn(300)}),n(document).on("click",".wcefp-quick-reply",function(){const e=n(this).text(),t={"Info prezzi":"I nostri prezzi includono tutto: guida esperta, attrezzatura e assicurazione. Offriamo anche il prezzo garantito pi√π basso!","Disponibilit√†":"Controlliamo la disponibilit√† in tempo reale. Puoi prenotare fino a 2 ore prima dell'esperienza!",Cancellazioni:"Cancellazione gratuita fino a 24 ore prima dell'esperienza. Rimborso completo garantito!"};this.addMessage(e,"user"),setTimeout(()=>{this.addMessage(t[e]||"Grazie per la tua domanda. Un operatore ti risponder√† presto!","bot")},1e3)}),n(document).on("click",".wcefp-chat-send",()=>{const e=n(".wcefp-chat-input input"),t=e.val().trim();t&&(this.addMessage(t,"user"),e.val(""),setTimeout(()=>{this.addMessage("Grazie per il tuo messaggio! Un operatore ti risponder√† il prima possibile.","bot")},1500))})}addMessage(e,t){const i=n(`\n                <div class="wcefp-chat-message wcefp-${t}-message">\n                    <p>${e}</p>\n                </div>\n            `);n(".wcefp-chat-messages").append(i),n(".wcefp-chat-messages")[0].scrollTop=n(".wcefp-chat-messages")[0].scrollHeight}}n(document).ready(function(){window.wcefpConversionOptimizer=new e,window.wcefpLiveSupport=new t,"undefined"!=typeof WCEFPAnalytics&&window.wcefpAnalytics&&window.wcefpAnalytics.track("conversion_optimization_loaded",{features:["urgency_indicators","social_proof","dynamic_pricing","scarcity_indicators","trust_badges","exit_intent","price_comparison","live_support"]})})}(jQuery);